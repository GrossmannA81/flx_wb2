<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Your project • RTemplate</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,300;0,400;0,700;1,300;1,400&amp;display=swap" rel="stylesheet">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- geco --><link href="geco.css" rel="stylesheet">
<meta property="og:title" content="Your project">
<meta property="og:description" content="What the package does (one paragraph).">
<meta name="twitter:card" content="summary">
<!-- Mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js" async integrity="sha256-nlrDrBTHxJJlDDX22AS33xYI1OJHnGMDhiYMSe2U0e0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/config/TeX-AMS-MML_HTMLorMML.js" async integrity="sha256-4zys9A4hMQmtq2EUL+JRoXc0NZi8jVJMzb8onewOaSQ=" crossorigin="anonymous"></script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="external-link hidden-sm hidden-xs" href="https://geco-group.org/">
          <img src="https://raw.githubusercontent.com/computationales/GECO_template/main/geco_logo_white_small.png" id="hexlogo" alt="GECO"></a>
        <a class="external-link hidden-md hidden-lg" href="https://geco-group.org/">
          <img src="https://raw.githubusercontent.com/computationales/GECO_template/main/geco_logo_white_small.png" id="hexlogo" alt="GECO"></a>
        <a class="navbar-brand" href="index.html">
           <i>RTemplate <small>v0.1</small></i>
        </a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">Reference</a>
</li>

      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="actual-evapotranspiration-in-arid-and-semi-arid-regions">Actual Evapotranspiration in Arid and Semi-arid Regions<a class="anchor" aria-label="anchor" href="#actual-evapotranspiration-in-arid-and-semi-arid-regions"></a>
</h1></div>
<p>This project uses Eddy Covariance FluxDataKit, Condensation, Soil Thickness Data from Pelletier and Compound Topographic Index (CTI) Data to explain deviations of high aridity in combination with high actual evapotranspiration from the theoretical Budyko framework.</p>
<div class="section level3">
<h3 id="scenarios-in-order-to-compare-different-impacts-of-condensation-with-or-without-and">Scenarios: in order to compare different impacts of condensation (with or without) and<a class="anchor" aria-label="anchor" href="#scenarios-in-order-to-compare-different-impacts-of-condensation-with-or-without-and"></a>
</h3>
<p>letant energy (corrected or not), 4 scenarios are distinguished:</p>
<ul>
<li>without condensation + gap filled latent energy</li>
<li>wihtout condensation + corrected latent energy</li>
<li>with condensation + gap filled latent energy</li>
<li>with condensation + corrected latent energy</li>
</ul>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="section level3">
<h3 id="fluxdatakit">FluxDataKit<a class="anchor" aria-label="anchor" href="#fluxdatakit"></a>
</h3>
<p>The FLuxDataKit (version 3.4) provides flux tower records from <a href="https://doi.org/10.5281/zenodo.10885933" class="external-link">Zenodo</a> and delivers half hourly and daily data from PLUMBER2 (Ukkola, 2021), Ameriflux (Ameriflux, 2023; Pastorello, 2020), ICOS Drought2018 (ICOS, 2018), ICOS WarmWinter2020 (ICOS, 2020). The data is available for each site.</p>
<p>path to files:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">-</span> ~/data_2/FluxDataKit/v3.4/zenodo_upload/fdk_site_info.csv</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">-</span> ~/data_2/FluxDataKit/v3.4/zenodo_upload/fdk_site_fullyearsequence.csv</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="topography-from-marthews-2015">Topography from Marthews (2015)<a class="anchor" aria-label="anchor" href="#topography-from-marthews-2015"></a>
</h3>
<p>This NetCDF dataset is at grid layer which was upscaled to a resolution of 15 arcsec. Each grid cell has a geographical location holding a specific value for CTI.</p>
<p>path to file:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">-</span> ~/data/archive/gti_marthews_2015/data/ga2.nc</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="soil-thickness-from-pelletier-2016">Soil Thickness from Pelletier (2016)<a class="anchor" aria-label="anchor" href="#soil-thickness-from-pelletier-2016"></a>
</h3>
<p>This additional variable is an estimated thickness from bedrock to land surface. It comes with a spatial resolution of 1km grid, also provided in the NetCDF format. With exact coordinates, thickness is extracted and assigned to the sitenames of the FluxDataKit.</p>
<p>path to file:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">-</span> ~/data/archive/soil_pelletier_2016/data/Global_Soil_Regolith_Sediment_1304/data/average_soil_and_sedimentary-deposit_thickness.tif</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="condensation">Condensation<a class="anchor" aria-label="anchor" href="#condensation"></a>
</h3>
<p>The P-Model calculates condensation by converting night time total net radiation into the equivalent mass of water. In order to check robustness of condensation which is added to precipitation, this additional factor helps to distinguish different scenarios.</p>
<p>path to file:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">-</span> ~/data_2/FluxDataKit/v3.4/zenodo_upload/rsofun_driver_data_v3.4.2.rds</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="structure">Structure<a class="anchor" aria-label="anchor" href="#structure"></a>
</h2>
<p>This project is structured as followed and shall be run in sequenced order:</p>
<pre><code>data-raw/
   ├─ 00_Download_Data.R
   ├─ 01_P_Model_RSOFUN.R
data/
   ├─ 01_Mean_Table.R
   ├─ 02_Budyko.R

analysis/
   ├─ 00_Budyko_Plots.R
   ├─ 01_Aridity_Plots.R
   ├─ 02_Site-Characteristics.R
   ├─ 03_Statistics.R
   ├─ 04_RandomForest_Model.R
   ├─ pics/     #folder for outputs
   ├─ tables/   #folder for outputs</code></pre>
<div class="section level3">
<h3 id="data-raw">/data-raw<a class="anchor" aria-label="anchor" href="#data-raw"></a>
</h3>
<ul>
<li><p>00_Downolad_Data.R: This script gatters site infos and fullyearsequences from FluxDataKit. In a next step, needed Value from CTI is extracted and finally merged and written into the df_sites.csv file which will be stored in the /data folder.</p></li>
<li><p>01_P_Model_RSOFUN.R: Values of condensation are extracted and written into df_cond_mean_ann_2.csv. finally, these values are joined into the df_sites.csv file.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="data-1">/data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h3>
<ul>
<li>01_Mean-Table.R: The daily FluxDataKit data is loaded. With the function <code>fun_read_onesite()</code>entries matching <code>FLX_&lt;sitename&gt;_FLUXDATAKIT_FULLSET_DD*</code> are read from the CSV and tagged with the sitename. looping over all sitenames in <code>df_sites$sitename</code>, purr::map then combines them into the nex dataframe <code>daily_data</code>.</li>
</ul>
<p>functions for converting latent energy to evapotranspiration are execuded.</p>
<p>having mass flux in mm day-1, final values of precipitation <code>prec</code>, actual evapotranspiration <code>aet</code>, corrected aet <code>aet_corr</code>, each with and without condensation, and potential evapotranspration <code>pet</code> are joined to the main dataframe df_sites.csv</p>
<ul>
<li>02_Budyko.R: Here, the Budyko by Fu (1981) equations are introduced. For each scenario, the new dataframe <code>df_budyko</code> transmutes the variables of precipitation and actual aswell as potential evapotranspiration.</li>
</ul>
<p>finally, the residuals of the actual evapotranspiration from the theoretical (potential) evapotraspiration in the Budyko framework can be calculated, which delivers a value for each scenario.</p>
</div>
<div class="section level3">
<h3 id="analysis">/analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<ul>
<li>00_Budyko-Plots.R: The aim of this script is the visualization of the scenarios. In this sort, the plotting of the residuals in the in the Budyko framework and according histogram are the output of this script.</li>
</ul>
<p>see:</p>
<pre><code>analysis/
   ├─ pics/
      ├─ Budyko_Comparison_ALL.png
      ├─ Budyko_Residuals_ALL.png</code></pre>
<ul>
<li>01_Aridity-Plots.R: In order to filter out arid and semi-arid as well as high cti, the data is plit into quintiles.</li>
</ul>
<p>Based on the PET/P ratio, following splitting is defined for aridity: <code>H (Humid): PET/P &lt; 1</code> <code>SH (Semi-humid): 1 ≤ PET/P &lt; 2</code> <code>SA (Semi-arid): 2 ≤ PET/P &lt; 4</code> <code>A (Arid): PET/P ≥ 4</code></p>
<p>CTI is plit into quintiles as followed: <code>Very Low</code> <code>Low</code> <code>Medium</code> <code>High</code> <code>Very High</code></p>
<p>In this sort, <code>aridity_class_nocond</code>, <code>aridity_class</code>, and <code>cti_class</code> are the objects for the use of the extraction of the Fluxnet sites with high aridity and high CTI.</p>
<p>The outputs are:</p>
<pre><code>analysis/
   ├─ pics/
      ├─ AI_Boxplot_ALL.png
      ├─ Heatmap_ALL.png</code></pre>
<ul>
<li>02_Site-Characteristics.R: This script includes high CTI and aridity in a diagram showing the degree of deviations from Budyko. Also, site information (coordinates) with soil thickness data from Pelletier et al. (2016) is linked and integrated to result in two excel tables. Here, in addition to high CTI and aridity, soil thickness expands the dataset.</li>
</ul>
<p>The data is merged into <code>df_budyko</code></p>
<pre><code>analysis/
   ├─ pics/
      ├─ AI_CTI_Diagram_ALL.png
      ├─ Pelletier_LE_F_MDS.png
      ├─ Pelletier_LE_CORR.png
   ├─ tables/
      ├─ table_topsites.xlsx
      ├─ table_topsites_corr.xlsx</code></pre>
<ul>
<li>03_Statistics.R: Here, the linear model statistical analysis is executed for the estimation of coefficients with gap-filled and corrected latent energy.</li>
</ul>
<pre><code>analysis/
   ├─ pics/
      ├─ stat_lm_coefficients.png
      ├─ stat_lm_coefficients_corr.png</code></pre>
<ul>
<li>04_RandomForest_Model.R:</li>
</ul>
<p>To visualize the distribution of R² and RMSE, bowplots show the behavior of the different predictors (CTI, thickness and landcovertype). With the help of random forest outputs,</p>
<pre><code>analysis/
   ├─ pics/
      ├─ stat_rf_vip.png
      ├─ stat_rf_vip_corr.png
      ├─ stat_rf_comparison_ALL.png</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/AGPL-3" class="external-link">AGPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RTemplate</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>John Doe <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0000-0000-0000" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </div>
</div>


      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/geco-bern" target="_blank" class="external-link">
                          <div class="icon fab fa-github"></div></a>
                        <a href="https://geco-group.org" target="_blank" class="external-link">
                          <div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/SteniBocker/" target="_blank" class="external-link">
                          <div class="icon fab fa-twitter"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://geco-group.org/" class="external-link">GECO</a></li>
                            <li><a href="https://geco-group.org/people/" class="external-link">Our Team</a></li>
                            <li><a href="https://geco-group.org/contact/" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://github.com/geco-bern" class="external-link">Packages</a></li>
                            <li><a href="https://geco-group.org/publication/" class="external-link">Publications</a></li>
                            <li><a href="https://geco-group.org/post/" class="external-link">Blog</a></li>
                        </ul>
</div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>






  </body>
</html>
